import{r as e}from"./router-5U3rcizL.js";const t=()=>{const[t,r]=e.useState([]),[n]=e.useState(Date.now()),o=e.useCallback((e,t={},o="general")=>{const a={id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:e,category:o,properties:{...t,timestamp:(new Date).toISOString(),sessionTime:Date.now()-n,userAgent:navigator.userAgent,url:window.location.href,referrer:document.referrer}};return r(e=>[...e,a]),a.id},[n]),a=e.useCallback((e,t,r={})=>o("button_click",{button_name:e,location:t,...r},"interaction"),[o]),s=e.useCallback((e,t)=>o("page_navigation",{from_page:e,to_page:t},"navigation"),[o]),i=e.useCallback((e,t)=>o("time_spent",{section:e,duration_ms:t,duration_seconds:Math.round(t/1e3)},"engagement"),[o]),u=e.useCallback((e,t,r={})=>o("error_occurred",{error_message:e,error_location:t,...r},"error"),[o]),c=e.useCallback(()=>{const e=Date.now()-n;return{sessionDuration:e,sessionDurationMinutes:Math.round(e/6e4),totalEvents:t.length,eventsByCategory:t.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+1,e),{}),lastEventTime:t.length>0?t[t.length-1].properties.timestamp:null}},[t,n]),l=e.useCallback(()=>{r([])},[]);return e.useEffect(()=>{const e={name:"session_start",category:"session",properties:{platform:"web",device_type:/Mobile|Android|iPhone|iPad/.test(navigator.userAgent)?"mobile":"desktop",timestamp:(new Date).toISOString(),sessionTime:0,userAgent:navigator.userAgent,url:window.location.href,referrer:document.referrer}};r(t=>[...t,e]);const t=()=>{c()};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[]),{trackEvent:o,trackButtonClick:a,trackPageNavigation:s,trackTimeSpent:i,trackError:u,events:t,getSessionStats:c,clearEvents:l,sessionStartTime:n,sessionDuration:Date.now()-n}};export{t as u};
