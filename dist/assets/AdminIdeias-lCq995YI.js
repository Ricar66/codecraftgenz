import{a,j as e,ag as s,$ as i,ae as t,ah as n,ai as r,aj as c}from"./index-DQkRuPgL.js";import{r as o}from"./router-Bh7m2j_b.js";import{A as d}from"./AdminCard-ChVCY5T3.js";import{S as l}from"./StatusBadge-C-iKibtv.js";const _="_page_1bnvy_7",m="_header_1bnvy_17",h="_headerTitle_1bnvy_35",v="_headerIcon_1bnvy_47",j="_newIdeaBtn_1bnvy_89",x="_formCard_1bnvy_131",u="_formTitle_1bnvy_143",y="_form_1bnvy_131",b="_formGroup_1bnvy_169",N="_input_1bnvy_193",p="_textarea_1bnvy_195",g="_formActions_1bnvy_243",f="_saveBtn_1bnvy_255",S="_cancelBtn_1bnvy_257",C="_ideiasList_1bnvy_319",w="_emptyCard_1bnvy_331",D="_emptyState_1bnvy_339",T="_emptyIcon_1bnvy_349",B="_ideiaCard_1bnvy_365",I="_ideiaHeader_1bnvy_385",A="_ideiaTitulo_1bnvy_393",E="_ideiaMeta_1bnvy_407",k="_ideiaData_1bnvy_421",F="_ideiaContent_1bnvy_431",O="_ideiaActions_1bnvy_457",P="_voteBtn_1bnvy_467",$="_commentBtn_1bnvy_469",L="_active_1bnvy_529",q="_comentarioSection_1bnvy_539",G="_comentarioForm_1bnvy_551",H="_comentarioInput_1bnvy_563",J="_addCommentBtn_1bnvy_597",M="_comentariosList_1bnvy_627",R="_comentarioItem_1bnvy_653",V="_comentarioHeader_1bnvy_667",Z="_comentarioData_1bnvy_691",z="_loadingState_1bnvy_717",K="_spinner_1bnvy_737",Q="_errorState_1bnvy_763",U="_retryBtn_1bnvy_793";function W(){const[W,X]=o.useState([]),[Y,aa]=o.useState(!0),[ea,sa]=o.useState(""),[ia,ta]=o.useState(!1),[na,ra]=o.useState({titulo:"",descricao:""}),[ca,oa]=o.useState(null),[da,la]=o.useState(""),_a=async()=>{try{aa(!0),sa("");const e=await async function(){const e=await a("/api/ideias",{method:"GET"});return e?.data??e}();X(Array.isArray(e)?e:[])}catch(e){sa("Erro ao carregar ideias: "+e.message)}finally{aa(!1)}};o.useEffect(()=>{_a()},[]);const ma=async e=>{try{await async function(e){const s=await a(`/api/ideias/${e}/vote`,{method:"POST"});return s?.data??s}(e),X(W.map(a=>a.id===e?{...a,votos:(a.votos||0)+1}:a))}catch(s){alert("Erro ao votar: "+s.message)}},ha=async e=>{if(da.trim())try{await async function(e,s){const i=await a(`/api/ideias/${e}/comment`,{method:"POST",body:JSON.stringify({texto:s})});return i?.data??i}(e,da),la(""),oa(null),await _a()}catch(s){alert("Erro ao adicionar comentário: "+s.message)}else alert("Digite um comentário")},va=a=>new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return Y?e.jsx("div",{className:_,children:e.jsxs("div",{className:z,children:[e.jsx("div",{className:K}),e.jsx("p",{children:"Carregando ideias..."})]})}):ea?e.jsx("div",{className:_,children:e.jsx(d,{variant:"outlined",children:e.jsxs("div",{className:Q,children:[e.jsx("h3",{children:"Erro ao carregar ideias"}),e.jsx("p",{children:ea}),e.jsx("button",{onClick:_a,className:U,children:"Tentar novamente"})]})})}):e.jsxs("div",{className:_,children:[e.jsxs("header",{className:m,children:[e.jsxs("div",{className:h,children:[e.jsx(s,{className:v}),e.jsxs("div",{children:[e.jsx("h1",{children:"Ideias de Projeto"}),e.jsx("p",{children:"Compartilhe e colabore em ideias para novos projetos"})]})]}),e.jsx("button",{className:j,onClick:()=>ta(!ia),children:ia?e.jsxs(e.Fragment,{children:[e.jsx(i,{})," Cancelar"]}):e.jsxs(e.Fragment,{children:[e.jsx(t,{})," Nova Ideia"]})})]}),ia&&e.jsxs(d,{variant:"elevated",className:x,children:[e.jsx("h3",{className:u,children:"Adicionar Nova Ideia"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),na.titulo.trim()&&na.descricao.trim())try{await async function({titulo:e,descricao:s}){const i=await a("/api/ideias",{method:"POST",body:JSON.stringify({titulo:e,descricao:s})});return i?.data??i}(na),ra({titulo:"",descricao:""}),ta(!1),await _a()}catch(s){alert("Erro ao criar ideia: "+s.message)}else alert("Preencha todos os campos obrigatórios")},className:y,children:[e.jsxs("div",{className:b,children:[e.jsx("label",{htmlFor:"titulo",children:"Título *"}),e.jsx("input",{id:"titulo",type:"text",placeholder:"Título da ideia",value:na.titulo,onChange:a=>ra({...na,titulo:a.target.value}),className:N,required:!0})]}),e.jsxs("div",{className:b,children:[e.jsx("label",{htmlFor:"descricao",children:"Descrição Detalhada *"}),e.jsx("textarea",{id:"descricao",placeholder:"Descreva sua ideia em detalhes...",value:na.descricao,onChange:a=>ra({...na,descricao:a.target.value}),className:p,rows:"4",required:!0})]}),e.jsxs("div",{className:g,children:[e.jsxs("button",{type:"submit",className:f,children:[e.jsx(n,{})," Salvar Ideia"]}),e.jsxs("button",{type:"button",className:S,onClick:()=>ta(!1),children:[e.jsx(i,{})," Cancelar"]})]})]})]}),e.jsx("div",{className:C,children:0===W.length?e.jsx(d,{variant:"outlined",className:w,children:e.jsxs("div",{className:D,children:[e.jsx(s,{className:T}),e.jsx("p",{children:"Nenhuma ideia cadastrada ainda."}),e.jsx("p",{children:"Seja o primeiro a compartilhar uma ideia!"})]})}):W.map(a=>e.jsxs(d,{variant:"elevated",className:B,children:[e.jsxs("div",{className:I,children:[e.jsx("h3",{className:A,children:a.titulo}),e.jsxs("div",{className:E,children:[e.jsxs(l,{variant:"info",children:["por ",a.autor]}),e.jsx("span",{className:k,children:va(a.data_criacao)})]})]}),e.jsx("div",{className:F,children:e.jsx("p",{children:a.descricao})}),e.jsxs("div",{className:O,children:[e.jsxs("button",{className:P,onClick:()=>ma(a.id),title:"Votar nesta ideia",children:[e.jsx(r,{})," ",a.votos]}),e.jsxs("button",{className:`${$} ${ca===a.id?L:""}`,onClick:()=>oa(ca===a.id?null:a.id),children:[e.jsx(c,{})," ",a.comentarios.length]})]}),ca===a.id&&e.jsxs("div",{className:q,children:[e.jsxs("div",{className:G,children:[e.jsx("textarea",{placeholder:"Deixe seu comentário...",value:da,onChange:a=>la(a.target.value),className:H,rows:"2"}),e.jsxs("button",{className:J,onClick:()=>ha(a.id),children:[e.jsx(t,{})," Adicionar"]})]}),a.comentarios.length>0&&e.jsxs("div",{className:M,children:[e.jsx("h4",{children:"Comentários:"}),a.comentarios.map(a=>e.jsxs("div",{className:R,children:[e.jsxs("div",{className:V,children:[e.jsx("strong",{children:a.autor}),e.jsx("span",{className:Z,children:va(a.data)})]}),e.jsx("p",{children:a.texto})]},a.id))]})]})]},a.id))})]})}export{W as default};
