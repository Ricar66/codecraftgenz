import{u as e,j as a,a as s}from"./index-B77senA0.js";import{r}from"./router-5U3rcizL.js";import{C as i}from"./ChallengeCard-B3bW1SPg.js";import{N as t}from"./Navbar-CklyrCvR.js";import{r as n}from"./realtime-BxkdmVbQ.js";import"./urlSanitize-Bu_u8ZdG.js";const l="_page_4w11b_9",o="_hero_4w11b_77",c="_heroTitle_4w11b_95",d="_heroSubtitle_4w11b_137",_="_heroLead_4w11b_151",h="_challengesSection_4w11b_301",m="_carouselContainer_4w11b_319",u="_carouselTrack_4w11b_329",b="_navBtn_4w11b_381",p="_navBtnLeft_4w11b_431",v="_navBtnRight_4w11b_439",f="_challengeSnap_4w11b_449",j="_challengeActions_4w11b_465",x="_participateBtn_4w11b_479",g="_deliveryForm_4w11b_533",y="_deliveryInput_4w11b_543",N="_deliveryBtn_4w11b_581",w="_emptyState_4w11b_627",S="_emptyIcon_4w11b_643",C="_emptyTitle_4w11b_655",E="_emptyText_4w11b_667",T="_errorState_4w11b_677",k="_loadingState_4w11b_697",B="_spinner_4w11b_709",L="_footerSection_4w11b_739",R="_footerCard_4w11b_755",$="_footerText_4w11b_771";function F(){const[F,A]=r.useState([]),[O,U]=r.useState(!0),[I,P]=r.useState(""),[V,q]=r.useState({}),{user:z}=e(),D=async()=>{try{U(!0),P("");const e=await s("/api/desafios",{method:"GET"}),a=Array.isArray(e?.data)?e.data:[];A(a)}catch(e){P(e?.message||"Falha ao carregar desafios"),A([])}finally{U(!1)}};r.useEffect(()=>{D();const e=n.subscribe("desafios_changed",()=>D());return()=>e()},[]);const J=r.useRef(null),Q=e=>{const a=J.current;if(!a)return;const s=Math.round(.9*a.clientWidth);a.scrollBy({left:e*s,behavior:"smooth"})};return a.jsxs("div",{className:l,children:[a.jsx(t,{}),a.jsxs("header",{className:o,children:[a.jsx("h1",{className:c,children:"Desafios Epicos"}),a.jsx("h2",{className:d,children:"Desafios que moldam gigantes"}),a.jsx("p",{className:_,children:"Cada missao CodeCraft e uma oportunidade de testar suas habilidades e crescer como desenvolvedor. Aceite o desafio!"})]}),a.jsxs("section",{className:h,children:[O&&a.jsxs("div",{className:k,children:[a.jsx("div",{className:B}),a.jsx("p",{children:"Carregando desafios..."})]}),!O&&I&&a.jsx("div",{className:T,role:"alert",children:I}),!O&&!I&&F.length>0&&a.jsxs("div",{className:m,children:[a.jsx("button",{className:`${b} ${p}`,onClick:()=>Q(-1),"aria-label":"Ver anteriores",children:"â—€"}),a.jsx("div",{className:u,ref:J,"aria-live":"polite",children:F.map(e=>a.jsxs("div",{className:f,children:[a.jsx(i,{challenge:e}),a.jsxs("div",{className:j,children:[a.jsx("button",{className:x,onClick:()=>(async e=>{const a=z?.id;if(!a)return void alert("E necessario estar autenticado para participar.");const r={crafter_id:a};try{await s(`/api/desafios/${e}/inscrever`,{method:"POST",body:JSON.stringify(r)}),alert("Inscricao realizada!"),n.publish("desafios_changed",{})}catch(i){alert(i.message||"Falha ao inscrever")}})(e.id),disabled:"active"!==e.status,children:"active"===e.status?"Quero participar!":"Encerrado"}),("link"===e.delivery_type||"github"===e.delivery_type)&&a.jsxs("div",{className:g,children:[a.jsx("input",{type:"text",placeholder:"github"===e.delivery_type?"URL do repositorio":"URL da entrega",value:V[e.id]||"",onChange:a=>q(s=>({...s,[e.id]:a.target.value})),className:y,"aria-label":"URL da entrega"}),a.jsx("button",{className:N,onClick:()=>(async e=>{const a=String(V[e.id]||"").trim();if(("link"===e.delivery_type||"github"===e.delivery_type)&&!/^https?:\/\//i.test(a))return void alert("URL invalida.");const r=z?.id;if(!r)return void alert("E necessario estar autenticado para enviar a entrega.");const i={crafter_id:r,delivery:{url:a,notes:""}};try{await s(`/api/desafios/${e.id}/entregar`,{method:"POST",body:JSON.stringify(i)}),alert("Entrega enviada!"),n.publish("desafios_changed",{}),q(a=>({...a,[e.id]:""}))}catch(t){alert(t.message||"Falha ao enviar")}})(e),disabled:"active"!==e.status,children:"Enviar"})]})]})]},e.id))}),a.jsx("button",{className:`${b} ${v}`,onClick:()=>Q(1),"aria-label":"Ver proximos",children:"â–¶"})]}),!O&&!I&&0===F.length&&a.jsxs("div",{className:w,children:[a.jsx("div",{className:S,children:"ðŸŽ¯"}),a.jsx("h3",{className:C,children:"Nenhum desafio ativo"}),a.jsx("p",{className:E,children:"Volte em breve para conferir novos desafios e testar suas habilidades!"})]})]}),a.jsx("section",{className:L,children:a.jsx("div",{className:R,children:a.jsx("p",{className:$,children:"Nossos desafios nao sao apenas testes. Sao experiencias que transformam Crafters em verdadeiros criadores do amanha."})})})]})}export{F as default};
