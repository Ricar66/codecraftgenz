import"./router-5U3rcizL.js";const e=new class{constructor(){this.metrics=new Map,this.observers=new Map,this.isEnabled=!0,this.startTime=performance.now()}startMeasure(e,t={}){if(!this.isEnabled)return;const r=performance.now();return this.metrics.set(e,{name:e,startTime:r,metadata:t,status:"running"}),performance.mark&&performance.mark(`${e}-start`),r}endMeasure(e,t={}){if(!this.isEnabled)return;const r=performance.now(),s=this.metrics.get(e);if(!s)return;const n=r-s.startTime;return this.metrics.set(e,{...s,endTime:r,duration:n,result:t,status:"completed"}),performance.mark&&performance.measure&&(performance.mark(`${e}-end`),performance.measure(e,`${e}-start`,`${e}-end`)),n}async measureAsync(e,t,r={}){this.startMeasure(e,r);try{const r=await t();return this.endMeasure(e,{success:!0,result:r}),r}catch(s){throw this.endMeasure(e,{success:!1,error:s.message}),s}}measureSync(e,t,r={}){this.startMeasure(e,r);try{const r=t();return this.endMeasure(e,{success:!0,result:r}),r}catch(s){throw this.endMeasure(e,{success:!1,error:s.message}),s}}observeElement(e,t,r={}){if(!e||!("IntersectionObserver"in window))return;const s=new IntersectionObserver(e=>{e.forEach(e=>{const r={timestamp:performance.now(),isIntersecting:e.isIntersecting,intersectionRatio:e.intersectionRatio};t(e,r)})},r);s.observe(e);const n=`observer-${Date.now()}`;return this.observers.set(n,s),n}stopObserving(e){const t=this.observers.get(e);t&&(t.disconnect(),this.observers.delete(e))}getBrowserMetrics(){const e=performance.getEntriesByType("navigation")[0],t=performance.getEntriesByType("paint");return{navigation:e?{domContentLoaded:e.domContentLoadedEventEnd-e.domContentLoadedEventStart,loadComplete:e.loadEventEnd-e.loadEventStart,domInteractive:e.domInteractive-e.navigationStart,firstByte:e.responseStart-e.requestStart}:null,paint:t.reduce((e,t)=>(e[t.name]=t.startTime,e),{}),memory:performance.memory?{used:performance.memory.usedJSHeapSize,total:performance.memory.totalJSHeapSize,limit:performance.memory.jsHeapSizeLimit}:null,now:performance.now()}}getStats(){const e=Array.from(this.metrics.values()),t=e.filter(e=>"completed"===e.status);if(0===t.length)return{total:e.length,completed:0,running:e.length,averageDuration:0,slowOperations:[]};const r=t.map(e=>e.duration),s=r.reduce((e,t)=>e+t,0)/r.length,n=t.filter(e=>e.duration>1e3).sort((e,t)=>t.duration-e.duration);return{total:e.length,completed:t.length,running:e.length-t.length,averageDuration:Math.round(100*s)/100,minDuration:Math.min(...r),maxDuration:Math.max(...r),slowOperations:n.slice(0,5),browserMetrics:this.getBrowserMetrics()}}getDetailedMetrics(){return{metrics:Array.from(this.metrics.values()),stats:this.getStats(),uptime:performance.now()-this.startTime}}clear(){this.metrics.clear(),this.observers.forEach(e=>e.disconnect()),this.observers.clear(),performance.clearMarks&&performance.clearMarks(),performance.clearMeasures&&performance.clearMeasures()}setEnabled(e){this.isEnabled=e,e||this.clear()}exportMetrics(){return{timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,...this.getDetailedMetrics()}}};export{e as g};
