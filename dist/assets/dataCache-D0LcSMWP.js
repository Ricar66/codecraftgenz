class t{constructor(t=3e5){this.cache=new Map,this.defaultTTL=t,this.stats={hits:0,misses:0,sets:0,evictions:0}}generateKey(t,s={}){const e=Object.keys(s).sort().reduce((t,e)=>(t[e]=s[e],t),{});return`${t}:${JSON.stringify(e)}`}set(t,s,e=this.defaultTTL){const i=Date.now()+e;this.cache.set(t,{data:s,expiresAt:i,createdAt:Date.now(),accessCount:0}),this.stats.sets++,this.cleanup()}get(t){const s=this.cache.get(t);return s?Date.now()>s.expiresAt?(this.cache.delete(t),this.stats.misses++,this.stats.evictions++,null):(s.accessCount++,this.stats.hits++,s.data):(this.stats.misses++,null)}has(t){const s=this.cache.get(t);return!!s&&(!(Date.now()>s.expiresAt)||(this.cache.delete(t),this.stats.evictions++,!1))}delete(t){const s=this.cache.delete(t);return s&&this.stats.evictions++,s}cleanup(){const t=Date.now();let s=0;for(const[e,i]of this.cache.entries())t>i.expiresAt&&(this.cache.delete(e),s++);return this.stats.evictions+=s,s}clear(){const t=this.cache.size;return this.cache.clear(),this.stats.evictions+=t,t}getStats(){const t=this.stats.hits+this.stats.misses,s=t>0?this.stats.hits/t*100:0;return{...this.stats,size:this.cache.size,hitRate:Math.round(100*s)/100,totalRequests:t}}getEntries(){const t=[],s=Date.now();for(const[e,i]of this.cache.entries())t.push({key:e,size:JSON.stringify(i.data).length,age:s-i.createdAt,ttl:i.expiresAt-s,accessCount:i.accessCount,expired:s>i.expiresAt});return t.sort((t,s)=>s.accessCount-t.accessCount)}}const s=new t(6e5),e=new t(3e5);export{e as a,s as p};
