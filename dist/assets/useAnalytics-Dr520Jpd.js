import{r as e}from"./router-Bh7m2j_b.js";const t=()=>{const[t,n]=e.useState([]),[r]=e.useState(Date.now()),o=e.useCallback((e,t={},o="general")=>{const a={id:`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:e,category:o,properties:{...t,timestamp:(new Date).toISOString(),sessionTime:Date.now()-r,userAgent:navigator.userAgent,url:window.location.href,referrer:document.referrer}};return n(e=>[...e,a]),"undefined"!=typeof window&&"function"==typeof window.gtag&&window.gtag("event",e,{event_category:o,...t}),a.id},[r]),a=e.useCallback((e,t,n={})=>o("button_click",{button_name:e,location:t,...n},"interaction"),[o]),s=e.useCallback((e,t)=>o("page_navigation",{from_page:e,to_page:t},"navigation"),[o]),i=e.useCallback((e,t)=>o("time_spent",{section:e,duration_ms:t,duration_seconds:Math.round(t/1e3)},"engagement"),[o]),u=e.useCallback((e,t,n={})=>o("error_occurred",{error_message:e,error_location:t,...n},"error"),[o]),c=e.useCallback(()=>{const e=Date.now()-r;return{sessionDuration:e,sessionDurationMinutes:Math.round(e/6e4),totalEvents:t.length,eventsByCategory:t.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+1,e),{}),lastEventTime:t.length>0?t[t.length-1].properties.timestamp:null}},[t,r]),g=e.useCallback(()=>{n([])},[]);return e.useEffect(()=>{const e={name:"session_start",category:"session",properties:{platform:"web",device_type:/Mobile|Android|iPhone|iPad/.test(navigator.userAgent)?"mobile":"desktop",timestamp:(new Date).toISOString(),sessionTime:0,userAgent:navigator.userAgent,url:window.location.href,referrer:document.referrer}};n(t=>[...t,e]);const t=()=>{c()};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[]),{trackEvent:o,trackButtonClick:a,trackPageNavigation:s,trackTimeSpent:i,trackError:u,events:t,getSessionStats:c,clearEvents:g,sessionStartTime:r,sessionDuration:Date.now()-r}};export{t as u};
