import{a as e,j as s,c as a,ab as i,ac as r,b as t,ad as c,ae as n,aa as l,a7 as o,af as d,l as j}from"./index-sK2loqLz.js";import{r as m}from"./router-5U3rcizL.js";import{a as h}from"./projectsAPI-Dk1YwCPU.js";import{A as _,S as u}from"./StatusBadge-Du63B6PO.js";import"./dataCache-D0LcSMWP.js";const x="_page_1cvwj_7",v="_header_1cvwj_17",p="_headerTitle_1cvwj_35",f="_headerIcon_1cvwj_47",N="_message_1cvwj_91",w="_success_1cvwj_111",g="_error_1cvwj_123",b="_closeMessage_1cvwj_135",C="_tabs_1cvwj_157",q="_tab_1cvwj_157",E="_active_1cvwj_217",S="_tabContent_1cvwj_231",y="_section_1cvwj_245",M="_sectionTitle_1cvwj_255",P="_infoText_1cvwj_275",k="_tableWrapper_1cvwj_291",$="_table_1cvwj_291",A="_form_1cvwj_367",T="_formRow_1cvwj_379",I="_formGroup_1cvwj_401",L="_input_1cvwj_431",O="_select_1cvwj_433",B="_filterBar_1cvwj_481",z="_searchBox_1cvwj_495",D="_searchIcon_1cvwj_507",G="_searchInput_1cvwj_525",R="_primaryBtn_1cvwj_559",U="_secondaryBtn_1cvwj_561",V="_dangerBtn_1cvwj_563",J="_linkBtn_1cvwj_565",F="_emptyState_1cvwj_697",H="_teamsList_1cvwj_711",K="_projectGroup_1cvwj_723",Q="_projectTitle_1cvwj_737",W="_mentorTeamGroup_1cvwj_761",Y="_mentorHeader_1cvwj_783",X="_teamMembers_1cvwj_819",Z="_teamMemberCard_1cvwj_831",ee="_memberInfo_1cvwj_855",se="_memberAvatar_1cvwj_871",ae="_crafterAvatar_1cvwj_873",ie="_mentorAvatar_1cvwj_875",re="_avatarPlaceholder_1cvwj_889",te="_memberDetails_1cvwj_915",ce="_memberActions_1cvwj_947",ne="_statusSelect_1cvwj_959",le="_statusSelectSmall_1cvwj_961",oe="_addCrafterSection_1cvwj_995",de="_mentoresGrid_1cvwj_1029",je="_mentorCard_1cvwj_1041",me="_mentorCardHeader_1cvwj_1065",he="_mentorInfo_1cvwj_1087",_e="_mentorBio_1cvwj_1123",ue="_mentorProjects_1cvwj_1151",xe="_noProjects_1cvwj_1165",ve="_projectsList_1cvwj_1177",pe="_craftersGrid_1cvwj_1191",fe="_crafterCard_1cvwj_1203",Ne="_crafterHeader_1cvwj_1227",we="_crafterInfo_1cvwj_1249",ge="_points_1cvwj_1275",be="_crafterStatus_1cvwj_1297",Ce="_currentTeams_1cvwj_1307",qe="_teamInfo_1cvwj_1319",Ee="_craftersSelection_1cvwj_1339",Se="_crafterCheckbox_1cvwj_1363",ye="_selected_1cvwj_1395",Me="_crafterCheckboxInfo_1cvwj_1419",Pe="_selectionSummary_1cvwj_1451",ke="_previewCard_1cvwj_1471",$e="_muted_1cvwj_1481",Ae="_teamsGrid_1cvwj_1495",Te="_teamCard_1cvwj_1507",Ie="_teamMembersList_1cvwj_1535",Le="_memberItem_1cvwj_1547",Oe="_projectSection_1cvwj_1577",Be="_projectSectionTitle_1cvwj_1601",ze="_auditDetails_1cvwj_1623",De="_auditGrid_1cvwj_1645",Ge="_auditItem_1cvwj_1657",Re="_successState_1cvwj_1719",Ue="_successIcon_1cvwj_1737",Ve="_loadingState_1cvwj_1763",Je="_spinner_1cvwj_1783";function Fe(){const[Fe,He]=m.useState([]),[Ke,Qe]=m.useState([]),[We,Ye]=m.useState([]),[Xe,Ze]=m.useState([]),[es,ss]=m.useState(!0),[as,is]=m.useState("mentores"),[rs,ts]=m.useState(""),[cs,ns]=m.useState(""),[ls,os]=m.useState(""),[ds,js]=m.useState("todos"),[ms,hs]=m.useState({nome:"",email:"",avatar_url:""}),[_s,us]=m.useState({mentor_id:"",crafter_ids:[],projeto_id:"",status_inscricao:"inscrito"}),[xs,vs]=m.useState({projeto_id:"",mentor_id:""}),ps=m.useMemo(()=>Xe.reduce((e,s)=>(e[s.projeto_id]||(e[s.projeto_id]=[]),e[s.projeto_id].push(s),e),{}),[Xe]);m.useEffect(()=>{fs()},[]),m.useEffect(()=>{try{const e=new URLSearchParams(window.location.search),s=e.get("prefill_nome"),a=e.get("prefill_email"),i=e.get("prefill_avatar_url"),r=e.get("scroll");(s||a||i)&&(is("mentores"),hs(e=>({nome:s||e.nome||"",email:a||e.email||"",avatar_url:i||e.avatar_url||""})),ts("Campos do crafter pré-preenchidos a partir da inscrição."),"create-crafter"===r&&setTimeout(()=>{const e=document.getElementById("create-crafter");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},150))}catch{}},[]);const fs=async()=>{try{ss(!0);const[s,a,i,r]=await Promise.all([e("/api/mentores",{method:"GET"}),h(),e("/api/crafters",{method:"GET"}),e("/api/equipes",{method:"GET"})]),t=(s.data||[]).map(e=>({id:e.id,nome:e.nome,email:e.email,telefone:e.telefone,bio:e.bio,avatar_url:e.avatar_url||e.foto_url||e.photo||"",visible:e.visible}));He(t),Qe(Array.isArray(a)?a:[]),Ye(i.data||[]),Ze(r.data||[])}catch(s){}finally{ss(!1)}},Ns=m.useMemo(()=>{const e={};return Xe.forEach(s=>{e[s.crafter_id]||(e[s.crafter_id]=[]),e[s.crafter_id].push(s)}),e},[Xe]),ws=m.useMemo(()=>Fe.filter(e=>!Xe.some(s=>s.mentor_id===e.id)),[Fe,Xe]),gs=m.useMemo(()=>Ke.filter(e=>!Xe.some(s=>s.projeto_id===e.id)),[Ke,Xe]),bs=m.useMemo(()=>Ke.filter(e=>new Set(Xe.filter(s=>s.projeto_id===e.id).map(e=>e.mentor_id)).size>1),[Ke,Xe]),Cs=m.useMemo(()=>We.filter(e=>!Xe.some(s=>s.crafter_id===e.id)),[We,Xe]),qs=m.useMemo(()=>{const e={};return Xe.forEach(s=>{e[s.crafter_id]=(e[s.crafter_id]||0)+1}),We.filter(s=>(e[s.id]||0)>1)},[Xe,We]),Es=m.useMemo(()=>Xe.filter(e=>!Fe.find(s=>s.id===e.mentor_id)||!We.find(s=>s.id===e.crafter_id)||!Ke.find(s=>s.id===e.projeto_id)),[Xe,Fe,We,Ke]),Ss=m.useMemo(()=>{const e={},s=[];return Xe.forEach(a=>{const i=`${a.mentor_id}-${a.crafter_id}-${a.projeto_id}`;e[i]?s.push(a):e[i]=!0}),s},[Xe]),ys=m.useMemo(()=>Fe.filter(e=>e.nome.toLowerCase().includes(cs.toLowerCase())||e.email.toLowerCase().includes(cs.toLowerCase())),[Fe,cs]),Ms=m.useMemo(()=>We.filter(e=>{const s=e.nome.toLowerCase().includes(ls.toLowerCase())||e.email.toLowerCase().includes(ls.toLowerCase());if("todos"===ds)return s;const a=Ns[e.id]||[];return"disponivel"===ds?s&&0===a.length:"ocupado"===ds?s&&a.length>0:s}),[We,ls,ds,Ns]),Ps=async(s,a)=>{try{await e(`/api/equipes/${s}/status`,{method:"PUT",body:JSON.stringify({status_inscricao:a})})&&fs()}catch(i){}};if(es)return s.jsx("div",{className:x,children:s.jsxs("div",{className:Ve,children:[s.jsx("div",{className:Je}),s.jsx("p",{children:"Carregando dados de mentores, crafters e projetos..."})]})});const ks=Ke.find(e=>e.id===_s.projeto_id),$s=Fe.find(e=>e.id===_s.mentor_id);return s.jsxs("div",{className:x,children:[s.jsx("header",{className:v,children:s.jsxs("div",{className:p,children:[s.jsx(a,{className:f}),s.jsxs("div",{children:[s.jsx("h1",{children:"Gerenciamento de Equipes"}),s.jsxs("p",{children:[Fe.length," mentores | ",We.length," crafters | ",Xe.length," equipes"]})]})]})}),rs&&s.jsxs("div",{className:`${N} ${rs.includes("Erro")?g:w}`,children:[rs,s.jsx("button",{onClick:()=>ts(""),className:b,children:"×"})]}),s.jsxs("div",{className:C,children:[s.jsxs("button",{className:`${q} ${"mentores"===as?E:""}`,onClick:()=>is("mentores"),children:[s.jsx(i,{})," Mentores"]}),s.jsxs("button",{className:`${q} ${"associacoes"===as?E:""}`,onClick:()=>is("associacoes"),children:[s.jsx(r,{})," Associações"]}),s.jsxs("button",{className:`${q} ${"equipes"===as?E:""}`,onClick:()=>is("equipes"),children:[s.jsx(t,{})," Equipes"]}),s.jsxs("button",{className:`${q} ${"auditoria"===as?E:""}`,onClick:()=>is("auditoria"),children:[s.jsx(c,{})," Auditoria"]})]}),"mentores"===as&&s.jsxs("div",{className:S,children:[s.jsxs(_,{variant:"elevated",className:y,children:[s.jsx("h2",{className:M,children:"Mentores Disponíveis"}),s.jsxs("p",{className:P,children:["Os mentores são gerenciados na ",s.jsx("strong",{children:"página de Mentores"})," do sistema."]}),s.jsx("div",{className:k,children:s.jsxs("table",{className:$,children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Nome"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Telefone"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Bio"})]})}),s.jsx("tbody",{children:Fe.map(e=>s.jsxs("tr",{children:[s.jsx("td",{"data-label":"Nome",children:e.nome}),s.jsx("td",{"data-label":"Email",children:e.email}),s.jsx("td",{"data-label":"Telefone",children:e.telefone||"-"}),s.jsx("td",{"data-label":"Status",children:s.jsx(u,{variant:e.visible?"success":"neutral",children:e.visible?"Visível":"Oculto"})}),s.jsx("td",{"data-label":"Bio",children:e.bio?e.bio.substring(0,50)+"...":"-"})]},e.id))})]})})]}),s.jsxs(_,{variant:"elevated",className:y,id:"create-crafter",children:[s.jsxs("h2",{className:M,children:[s.jsx(n,{})," Criar Novo Crafter"]}),s.jsxs("form",{onSubmit:async s=>{s.preventDefault();try{const s=(ms.email||"").trim().toLowerCase();if(!s)return void ts("Informe um email válido para criar o crafter.");if(We.some(e=>(e.email||"").trim().toLowerCase()===s))return ts("Já existe um crafter com este email."),void alert("Já existe um crafter com este email.");await e("/api/crafters",{method:"POST",body:JSON.stringify(ms)})&&(hs({nome:"",email:"",avatar_url:""}),fs())}catch(a){}},className:A,children:[s.jsxs("div",{className:T,children:[s.jsx("input",{type:"text",placeholder:"Nome",value:ms.nome,onChange:e=>hs({...ms,nome:e.target.value}),className:L,required:!0}),s.jsx("input",{type:"email",placeholder:"Email",value:ms.email,onChange:e=>hs({...ms,email:e.target.value}),className:L,required:!0})]}),s.jsx("div",{className:T,children:s.jsx("input",{type:"url",placeholder:"URL do Avatar",value:ms.avatar_url,onChange:e=>hs({...ms,avatar_url:e.target.value}),className:L})}),s.jsxs("button",{type:"submit",className:R,children:[s.jsx(n,{})," Criar Crafter"]})]})]}),s.jsxs(_,{variant:"elevated",className:y,children:[s.jsxs("h2",{className:M,children:[s.jsx(t,{})," Equipes Existentes"]}),s.jsx("p",{className:P,children:"Visualize e edite as equipes já formadas."}),0===Object.keys(ps).length?s.jsx("div",{className:F,children:s.jsx("p",{children:"Nenhuma equipe criada ainda."})}):s.jsx("div",{className:H,children:Object.entries(ps).map(([a,r])=>s.jsxs("div",{className:K,children:[s.jsxs("h3",{className:Q,children:[s.jsx(t,{})," ",r[0]?.projeto_titulo||"Projeto sem título"]}),Object.entries(r.reduce((e,s)=>{const a=`${s.mentor_id}-${s.mentor_nome}`;return e[a]||(e[a]=[]),e[a].push(s),e},{})).map(([r,t])=>{const[c,o]=r.split("-");return s.jsxs("div",{className:W,children:[s.jsxs("div",{className:Y,children:[s.jsxs("h4",{children:[s.jsx(i,{})," ",o]}),s.jsxs(u,{variant:"info",children:[t.length," crafter",1!==t.length?"s":""]})]}),s.jsx("div",{className:X,children:t.map(a=>s.jsxs("div",{className:Z,children:[s.jsxs("div",{className:ee,children:[s.jsx("div",{className:se,children:a.crafter_avatar_url?s.jsx("img",{src:a.crafter_avatar_url,alt:a.crafter_nome}):s.jsx("div",{className:re,children:a.crafter_nome?.charAt(0).toUpperCase()})}),s.jsxs("div",{className:te,children:[s.jsx("strong",{children:a.crafter_nome}),s.jsx("small",{children:a.crafter_email}),s.jsxs(u,{variant:"finalizado"===a.status_inscricao?"success":"confirmado"===a.status_inscricao?"info":"warning",size:"sm",children:["inscrito"===a.status_inscricao&&"Inscrito","confirmado"===a.status_inscricao&&"Confirmado","finalizado"===a.status_inscricao&&"Finalizado"]})]})]}),s.jsxs("div",{className:ce,children:[s.jsxs("select",{value:a.status_inscricao,onChange:e=>Ps(a.id,e.target.value),className:ne,children:[s.jsx("option",{value:"inscrito",children:"Inscrito"}),s.jsx("option",{value:"confirmado",children:"Confirmado"}),s.jsx("option",{value:"finalizado",children:"Finalizado"})]}),s.jsx("button",{onClick:()=>(async s=>{if(window.confirm("Tem certeza que deseja remover este crafter da equipe?"))try{if(!(await e(`/api/equipes/${s}`,{method:"DELETE"})))throw new Error("Erro ao remover crafter da equipe");ts("Crafter removido da equipe com sucesso!"),fs()}catch(a){ts("Erro ao remover crafter da equipe")}})(a.id),className:V,title:"Remover crafter da equipe",children:s.jsx(l,{})})]})]},a.id))}),s.jsxs("div",{className:oe,children:[s.jsxs("h5",{children:[s.jsx(n,{})," Adicionar Crafter à Equipe"]}),s.jsxs("select",{value:"",onChange:s=>(async(s,a,i)=>{if(i)try{const r={mentor_id:s,crafter_id:i,projeto_id:a,status_inscricao:"inscrito"};if(!(await e("/api/equipes",{method:"POST",body:JSON.stringify(r)})))throw new Error("Erro ao adicionar crafter à equipe");ts("Crafter adicionado à equipe com sucesso!"),fs()}catch(r){ts("Erro ao adicionar crafter à equipe")}})(c,a,s.target.value),className:O,children:[s.jsx("option",{value:"",children:"Selecione um crafter para adicionar..."}),We.filter(e=>!t.some(s=>s.crafter_id===e.id)).map(e=>s.jsxs("option",{value:e.id,children:[e.nome," - ",e.email]},e.id))]})]})]},r)})]},a))})]})]}),"associacoes"===as&&s.jsxs("div",{className:S,children:[s.jsxs(_,{variant:"elevated",className:y,children:[s.jsxs("h2",{className:M,children:[s.jsx(i,{})," Mentores Disponíveis"]}),s.jsx("div",{className:B,children:s.jsxs("div",{className:z,children:[s.jsx(o,{className:D}),s.jsx("input",{type:"text",placeholder:"Buscar por nome ou email...",value:cs,onChange:e=>ns(e.target.value),className:G})]})}),0===ys.length?s.jsx("div",{className:F,children:s.jsx("p",{children:"Nenhum mentor encontrado."})}):s.jsx("div",{className:de,children:ys.map(e=>s.jsxs("div",{className:je,children:[s.jsxs("div",{className:me,children:[s.jsx("div",{className:ie,children:e.avatar_url?s.jsx("img",{src:e.avatar_url,alt:e.nome}):s.jsx("div",{className:re,children:e.nome.charAt(0).toUpperCase()})}),s.jsxs("div",{className:he,children:[s.jsx("h4",{children:e.nome}),s.jsx("p",{children:e.email}),e.telefone&&s.jsx("small",{children:e.telefone})]})]}),e.bio&&s.jsx("div",{className:_e,children:s.jsx("p",{children:e.bio})}),s.jsxs("div",{className:ue,children:[s.jsx("h5",{children:"Projetos Associados:"}),0===Ke.filter(s=>Xe.some(a=>a.mentor_id===e.id&&a.projeto_id===s.id)).length?s.jsx("span",{className:xe,children:"Nenhum projeto associado"}):s.jsx("div",{className:ve,children:Ke.filter(s=>Xe.some(a=>a.mentor_id===e.id&&a.projeto_id===s.id)).map(e=>s.jsx(u,{variant:"primary",size:"sm",children:e.titulo},e.id))})]})]},e.id))})]}),s.jsxs(_,{variant:"elevated",className:y,children:[s.jsxs("h2",{className:M,children:[s.jsx(a,{})," Crafters Cadastrados"]}),s.jsxs("div",{className:B,children:[s.jsxs("div",{className:z,children:[s.jsx(o,{className:D}),s.jsx("input",{type:"text",placeholder:"Buscar por nome ou email...",value:ls,onChange:e=>os(e.target.value),className:G})]}),s.jsxs("select",{value:ds,onChange:e=>js(e.target.value),className:O,children:[s.jsx("option",{value:"todos",children:"Todos"}),s.jsx("option",{value:"disponivel",children:"Disponíveis"}),s.jsx("option",{value:"ocupado",children:"Em Equipes"})]})]}),0===Ms.length?s.jsx("div",{className:F,children:s.jsx("p",{children:"Nenhum crafter encontrado."})}):s.jsx("div",{className:pe,children:Ms.map(e=>{const a=Ns[e.id]||[];return s.jsxs("div",{className:fe,children:[s.jsxs("div",{className:Ne,children:[s.jsx("div",{className:ae,children:e.avatar_url?s.jsx("img",{src:e.avatar_url,alt:e.nome}):s.jsx("div",{className:re,children:e.nome.charAt(0).toUpperCase()})}),s.jsxs("div",{className:we,children:[s.jsx("h4",{children:e.nome}),s.jsx("p",{children:e.email}),s.jsxs("span",{className:ge,children:[e.points||0," pontos"]})]})]}),s.jsx("div",{className:be,children:0===a.length?s.jsx(u,{variant:"success",dot:!0,children:"Disponível"}):s.jsxs("div",{className:Ce,children:[s.jsxs(u,{variant:"info",dot:!0,children:["Em ",a.length," equipe(s)"]}),a.map(e=>{const a=Ke.find(s=>s.id===e.projeto_id),i=Fe.find(s=>s.id===e.mentor_id);return s.jsx("div",{className:qe,children:s.jsxs("small",{children:[a?.titulo||"Projeto"," - ",i?.nome||"Mentor"]})},e.id)})]})})]},e.id)})})]}),s.jsxs(_,{variant:"elevated",className:y,children:[s.jsxs("h2",{className:M,children:[s.jsx(t,{})," Criar Nova Equipe"]}),s.jsxs("form",{onSubmit:async s=>{s.preventDefault();try{if(0===_s.crafter_ids.length)return void alert("Selecione pelo menos um crafter para a equipe");const s=await Promise.all(_s.crafter_ids.map(s=>e("/api/equipes",{method:"POST",body:JSON.stringify({mentor_id:_s.mentor_id,crafter_id:s,projeto_id:_s.projeto_id,status_inscricao:_s.status_inscricao})})));if(!s.every(Boolean))throw new Error("Algumas equipes não puderam ser criadas");us({mentor_id:"",crafter_ids:[],projeto_id:"",status_inscricao:"inscrito"}),fs(),alert(`Equipe criada com sucesso! ${_s.crafter_ids.length} crafter(s) adicionado(s).`)}catch(a){alert("Erro ao criar equipe: "+a.message)}},className:A,children:[s.jsxs("div",{className:T,children:[s.jsxs("div",{className:I,children:[s.jsxs("label",{children:[s.jsx(t,{})," Projeto"]}),s.jsxs("select",{value:_s.projeto_id,onChange:e=>us({..._s,projeto_id:e.target.value}),className:O,required:!0,children:[s.jsx("option",{value:"",children:"Selecione um Projeto"}),Ke.map(e=>s.jsx("option",{value:e.id,children:e.titulo},e.id))]})]}),s.jsxs("div",{className:I,children:[s.jsxs("label",{children:[s.jsx(i,{})," Mentor"]}),s.jsxs("select",{value:_s.mentor_id,onChange:e=>us({..._s,mentor_id:e.target.value}),className:O,required:!0,children:[s.jsx("option",{value:"",children:"Selecione um Mentor"}),Fe.map(e=>s.jsxs("option",{value:e.id,children:[e.nome," - ",e.email]},e.id))]})]})]}),s.jsxs("div",{className:I,children:[s.jsxs("label",{children:[s.jsx(a,{})," Crafters da Equipe"]}),s.jsx("div",{className:Ee,children:We.map(e=>s.jsxs("label",{className:`${Se} ${_s.crafter_ids.includes(e.id)?ye:""}`,children:[s.jsx("input",{type:"checkbox",checked:_s.crafter_ids.includes(e.id),onChange:s=>{s.target.checked?us({..._s,crafter_ids:[..._s.crafter_ids,e.id]}):us({..._s,crafter_ids:_s.crafter_ids.filter(s=>s!==e.id)})}}),s.jsxs("div",{className:Me,children:[s.jsx("strong",{children:e.nome}),s.jsx("small",{children:e.email})]})]},e.id))}),s.jsxs("div",{className:Pe,children:[s.jsx(d,{})," ",_s.crafter_ids.length," crafter(s) selecionado(s)"]})]}),s.jsx(_,{variant:"outlined",padding:"sm",className:ke,children:s.jsxs("div",{className:T,children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Nome da Equipe:"}),s.jsxs("p",{className:$e,children:[ks?.titulo||"Projeto não selecionado"," — ",$s?.nome||"Mentor não selecionado"]})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Participantes:"}),s.jsxs("p",{className:$e,children:[_s.crafter_ids.length," selecionado(s)"]})]})]})}),s.jsxs("div",{className:I,children:[s.jsx("label",{children:"Status Inicial"}),s.jsxs("select",{value:_s.status_inscricao,onChange:e=>us({..._s,status_inscricao:e.target.value}),className:O,children:[s.jsx("option",{value:"inscrito",children:"Inscrito"}),s.jsx("option",{value:"confirmado",children:"Confirmado"}),s.jsx("option",{value:"finalizado",children:"Finalizado"})]})]}),s.jsxs("button",{type:"submit",className:R,disabled:0===_s.crafter_ids.length,children:[s.jsx(t,{})," Criar Equipe (",_s.crafter_ids.length," crafter",1!==_s.crafter_ids.length?"s":"",")"]})]})]}),s.jsxs(_,{variant:"elevated",className:y,children:[s.jsxs("h2",{className:M,children:[s.jsx(r,{})," Associar Mentor a Projeto"]}),s.jsxs("form",{onSubmit:async s=>{s.preventDefault();try{await e(`/api/projetos/${xs.projeto_id}/mentor`,{method:"POST",body:JSON.stringify({mentor_id:xs.mentor_id})})&&(vs({projeto_id:"",mentor_id:""}),fs())}catch(a){}},className:A,children:[s.jsxs("div",{className:T,children:[s.jsxs("div",{className:I,children:[s.jsxs("label",{children:[s.jsx(t,{})," Projeto"]}),s.jsxs("select",{value:xs.projeto_id,onChange:e=>vs({...xs,projeto_id:e.target.value}),className:O,required:!0,children:[s.jsx("option",{value:"",children:"Selecione um Projeto"}),Ke.map(e=>s.jsx("option",{value:e.id,children:e.titulo},e.id))]})]}),s.jsxs("div",{className:I,children:[s.jsxs("label",{children:[s.jsx(i,{})," Mentor"]}),s.jsxs("select",{value:xs.mentor_id,onChange:e=>vs({...xs,mentor_id:e.target.value}),className:O,required:!0,children:[s.jsx("option",{value:"",children:"Selecione um Mentor"}),Fe.map(e=>s.jsxs("option",{value:e.id,children:[e.nome," - ",e.email]},e.id))]})]})]}),s.jsxs("button",{type:"submit",className:U,children:[s.jsx(r,{})," Associar Mentor ao Projeto"]})]})]})]}),"equipes"===as&&s.jsx("div",{className:S,children:s.jsxs(_,{variant:"elevated",className:y,children:[s.jsx("h2",{className:M,children:"Equipes Ativas"}),0===Object.keys(ps).length?s.jsx("div",{className:F,children:s.jsx("p",{children:"Nenhuma equipe encontrada."})}):Object.entries(ps).map(([e,a])=>s.jsxs("div",{className:Oe,children:[s.jsxs("h3",{className:Be,children:[s.jsx(t,{})," ",a[0]?.projeto_titulo||"Projeto sem título"]}),s.jsx("div",{className:Ae,children:Object.entries(a.reduce((e,s)=>{const a=s.mentor_nome;return e[a]||(e[a]=[]),e[a].push(s),e},{})).map(([e,a])=>s.jsxs(_,{variant:"outlined",className:Te,children:[s.jsxs("h4",{children:[s.jsx(i,{})," ",e]}),s.jsx("div",{className:Ie,children:a.map(e=>s.jsxs("div",{className:Le,children:[s.jsx("span",{children:e.crafter_nome}),s.jsxs("select",{value:e.status_inscricao,onChange:s=>Ps(e.id,s.target.value),className:le,children:[s.jsx("option",{value:"inscrito",children:"Inscrito"}),s.jsx("option",{value:"confirmado",children:"Confirmado"}),s.jsx("option",{value:"finalizado",children:"Finalizado"})]})]},e.id))})]},e))})]},e))]})}),"auditoria"===as&&s.jsx("div",{className:S,children:s.jsxs(_,{variant:"elevated",className:y,children:[s.jsxs("h2",{className:M,children:[s.jsx(c,{})," Auditoria de Relacionamentos"]}),s.jsx("p",{className:P,children:"Esta seção destaca inconsistências nas relações entre Mentores, Projetos, Crafters e Equipes."}),s.jsxs("button",{onClick:()=>{const e=[];ws.forEach(s=>e.push(["mentor_sem_projeto",s.id,s.nome||"",s.email||"",""])),gs.forEach(s=>e.push(["projeto_sem_mentor",s.id,"","",s.titulo||`Projeto #${s.id}`])),bs.forEach(s=>e.push(["projeto_multiplos_mentores",s.id,"","",s.titulo||`Projeto #${s.id}`])),Cs.forEach(s=>e.push(["crafter_sem_equipe",s.id,s.nome||"",s.email||"",""])),qs.forEach(s=>e.push(["crafter_multiplas_equipes",s.id,s.nome||"",s.email||"",""])),Es.forEach(s=>e.push(["equipe_ref_invalida",s.id,s.nome||"","",""])),Ss.forEach(s=>e.push(["equipe_duplicada",s.id,s.nome||"","",""]));const s=[["categoria","id","nome","email","titulo_projeto"].join(","),...e.map(e=>e.map(e=>String(e).replace(/\n/g," ").replace(/"/g,'"')).join(","))].join("\n"),a=new Blob([s],{type:"text/csv;charset=utf-8;"}),i=URL.createObjectURL(a),r=document.createElement("a");r.href=i,r.download="auditoria_equipes.csv",r.click(),URL.revokeObjectURL(i)},className:U,children:[s.jsx(j,{})," Exportar CSV das inconsistências"]}),s.jsx("div",{className:k,children:s.jsxs("table",{className:$,children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Verificação"}),s.jsx("th",{children:"Quantidade"}),s.jsx("th",{children:"Ação"})]})}),s.jsxs("tbody",{children:[s.jsxs("tr",{children:[s.jsx("td",{children:"Mentores sem equipes/projetos"}),s.jsx("td",{children:s.jsx(u,{variant:ws.length>0?"warning":"success",children:ws.length})}),s.jsx("td",{children:s.jsx("button",{className:J,onClick:()=>is("associacoes"),children:"Ver Mentores"})})]}),s.jsxs("tr",{children:[s.jsx("td",{children:"Projetos sem mentor/equipe"}),s.jsx("td",{children:s.jsx(u,{variant:gs.length>0?"warning":"success",children:gs.length})}),s.jsx("td",{children:s.jsx("button",{className:J,onClick:()=>is("associacoes"),children:"Ver Projetos"})})]}),s.jsxs("tr",{children:[s.jsx("td",{children:"Projetos com múltiplos mentores"}),s.jsx("td",{children:s.jsx(u,{variant:bs.length>0?"info":"success",children:bs.length})}),s.jsx("td",{children:s.jsx("button",{className:J,onClick:()=>is("associacoes"),children:"Revisar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{children:"Crafters sem equipe"}),s.jsx("td",{children:s.jsx(u,{variant:Cs.length>0?"warning":"success",children:Cs.length})}),s.jsx("td",{children:s.jsx("button",{className:J,onClick:()=>is("associacoes"),children:"Adicionar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{children:"Crafters em múltiplas equipes"}),s.jsx("td",{children:s.jsx(u,{variant:qs.length>0?"info":"success",children:qs.length})}),s.jsx("td",{children:s.jsx("button",{className:J,onClick:()=>is("equipes"),children:"Ver Equipes"})})]}),s.jsxs("tr",{children:[s.jsx("td",{children:"Equipes com referências inválidas"}),s.jsx("td",{children:s.jsx(u,{variant:Es.length>0?"error":"success",children:Es.length})}),s.jsx("td",{children:s.jsx("button",{className:J,onClick:()=>is("equipes"),children:"Corrigir"})})]}),s.jsxs("tr",{children:[s.jsx("td",{children:"Equipes duplicadas"}),s.jsx("td",{children:s.jsx(u,{variant:Ss.length>0?"error":"success",children:Ss.length})}),s.jsx("td",{children:s.jsx("button",{className:J,onClick:()=>is("equipes"),children:"Remover"})})]})]})]})}),(ws.length>0||gs.length>0||Cs.length>0)&&s.jsxs(_,{variant:"outlined",className:ze,children:[s.jsx("h3",{children:"Detalhes das Inconsistências"}),s.jsxs("div",{className:De,children:[ws.length>0&&s.jsxs("div",{className:Ge,children:[s.jsx("h4",{children:"Mentores sem equipes"}),s.jsx("ul",{children:ws.map(e=>s.jsxs("li",{children:[e.nome," — ",e.email]},e.id))})]}),gs.length>0&&s.jsxs("div",{className:Ge,children:[s.jsx("h4",{children:"Projetos sem mentor"}),s.jsx("ul",{children:gs.map(e=>s.jsx("li",{children:e.titulo||`Projeto #${e.id}`},e.id))})]}),Cs.length>0&&s.jsxs("div",{className:Ge,children:[s.jsx("h4",{children:"Crafters sem equipe"}),s.jsx("ul",{children:Cs.map(e=>s.jsxs("li",{children:[e.nome," — ",e.email]},e.id))})]})]})]}),0===ws.length&&0===gs.length&&0===Cs.length&&0===qs.length&&0===Es.length&&0===Ss.length&&s.jsxs("div",{className:Re,children:[s.jsx(d,{className:Ue}),s.jsx("p",{children:"Nenhuma inconsistência encontrada. Tudo certo!"})]})]})})]})}export{Fe as default};
